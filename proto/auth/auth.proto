syntax = "proto3";

package auth;
option go_package = "github.com/go-chat-devs/proto-auth-x-gateway/gen/go/auth;authv1";

//lklfd
service Auth {
  //
  rpc Register(RegisterRequest) returns (RegisterResponse);
  //
  rpc Login(LoginRequest) returns (LoginResponse);
  //
  //
  rpc SetupTOTP(SetupTOTPRequest) returns (SetupTOTPResponse);
  //
  rpc SetupTOTPValidate(SetupTOTPValidateRequest) returns (SetupTOTPValidateResponse);
  //
  rpc ValidateTOTP(ValidateTOTPRequest) returns (ValidateTOTPResponse);
  //
  rpc Logout(LogoutRequest) returns (LogoutResponse);

}


//----------------------------------------------

message RegisterRequest {
  string email = 1;
  string password = 2;
  
}


message RegisterResponse {
}
//-----------------------------------------------------

message LoginRequest {
  string email = 1;
  string password = 2;
}


message ErrInvalidCredentials {
  string message = 1;
}

message LoginResponse {
  bytes token = 1;
}
//---------------------------


message Url {
  string url = 1;
  
}
message Key{
  string orig = 1;
  Url url = 2;
}



message SetupTOTPRequest {
  bytes sessionkey = 1;
}

message Res {
  Key key = 1;
  bytes token = 2;
}

message SetupTOTPResponse {
  Res res = 1;
}



//-----------------------


message ErrInvalidCode {
  string messsage =1;
}

message SetupTOTPValidateRequest {
  bytes sessionkey = 1;
  bytes setup2fa = 2;
  string code = 3;
}


message SetupTOTPValidateResponse {
}
//-----------------------


message ValidateTOTPRequest{
  bytes token2fa = 1;
  string code = 2;
}


message ValidateTOTPResponse {
  bytes sessionkey = 1;
}





//-----------------------------

message LogoutRequest {
  bytes sessionkey = 1;
  string password = 2;
}

message LogoutResponse {}

